---
title: 'Part 2: Basic Inferential Data Analysis'
author: "Yasser Gonzalez --- http://yassergonzalez.com"
date: "February 2015"
output:
  pdf_document: default
---

# Introduction

In the second part of the project we perform an analysis of the `ToothGrowth` 
data provided as part of the R `datasets` package. The dataset reports the 
results of a study of the effect of vitamin C on tooth growth in guinea pigs.
The length of the teeth was measured in 60 guinea pigs, corresponding to 
10 subjects for each combination of three dose levels of vitamin C 
(0.5, 1, and 2 mg) and two delivery methods (orange juice or ascorbic acid). 
The following references contain additional information about the dataset.

> Crampton, E. W. (1947) "The growth of the odontoblasts of the incisor 
> tooth as a criterion of the vitamin C intake of the guinea pig".
> The Journal of Nutrition, 33:5, 491-504.
> 
> C. I. Bliss (1952) "The Statistics of Bioassay". Academic Press.
> 
> McNeil, D. R. (1977) "Interactive Data Analysis". New York: Wiley.

# Loading the Required Packages

The following R packages are required to perform the analysis in this report.

```{r}
library("datasets")
library("dplyr", warn.conflicts = FALSE)
library("ggplot2")
```

# Exploratory Analysis

First, the dataset is loaded into R and the `str` function is used to obtain
some information about its structure.

```{r}
data(ToothGrowth)
ToothGrowth$dose <- factor(ToothGrowth$dose)
str(ToothGrowth)
```

The dataset contains 60 observations of three variables: `len` for the tooth length, 
`supp` for the delivery method (encoded as `"OJ"` and `"VC"` for orange juice and 
ascorbic acid, respectively), and `dose` for the dose level. The `dose` variable was 
originally represented as a numerical variable, but for the purpose of this 
analysis it is easier to treat it as a categorical variable with three levels 
and it was converted to factors.

In order to help us get a sense of the features in the data, the following code
builds a plot with a histogram of the tooth length for each combination of 
the values of the `supp` and `dose` variables.

```{r}
ggplot(ToothGrowth, aes(x = len)) +
    facet_grid(supp ~ dose) +
    geom_histogram(binwidth = 1) +
    labs(x = "Tooth Length", y = "Count")
```

The plot suggests that an increasing dose of vitamin C has a positive impact on 
tooth growth and that similar results are obtained with both delivery methods. 
The next section studies these hypotheses in more detail.

# Comparing Tooth Growth by Delivery Method and Dose Level

First we study the null hypothesis that both delivery methods produce similar results,
versus the alternative hypothesis that they give different results. To do so, we
conduct a two-sided $t$-test assuming different variances.

```{r}
t.test(filter(ToothGrowth, supp == "OJ")$len,
       filter(ToothGrowth, supp == "VC")$len,
       alternative = "two.sided", var.equal = FALSE, 
       conf.level = 0.95)
```

According to the results, there is no statistical evidence at the 5% confidence 
level to support the alternative hypothesis that the two means are different. 
Therefore, we can conclude that the two delivery methods produce similar results.

Next, we study the hypothesis that an increasing dose of vitamin C accelerate 
tooth growth independently of the delivery method. To do so, we perform two
one-sided $t$-tests, one for the 1 mg dose versus the 0.5 mg dose and
another for the 2 mg dose versus the 1 mg dose. In both cases the alternative
hypothesis is that larger doses accelerate tooth growth, according to the 
mean tooth length. The tests are conducted using the following R code.

```{r}
t.test(filter(ToothGrowth, dose == "1")$len,
       filter(ToothGrowth, dose == "0.5")$len,
       alternative = "greater", var.equal = FALSE, 
       conf.level = 0.95)

t.test(filter(ToothGrowth, dose == "2")$len,
       filter(ToothGrowth, dose == "1")$len,
       alternative = "greater", var.equal = FALSE, 
       conf.level = 0.95)
```

In both cases the obtained p-value is less than 0.05, wich means that the 
null hypothesis is rejected at the 5% significance level. Therefore, the 
evidence suggests that increasing dose levels of vitamin C accelerate 
tooth growth.

# Conclusions
